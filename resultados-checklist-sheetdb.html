<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resultados del Checklist</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" />
    <style>
        :root {
            /* Material Design 3 Color System */
            --md-primary: #7C3AED; /* Violeta vibrante */
            --md-primary-container: #EDE9FE; /* Violeta claro */
            --md-on-primary: #FFFFFF;
            --md-on-primary-container: #4C1D95;
            --md-secondary: #06B6D4; /* Cian/sky */
            --md-secondary-container: #CFFAFE;
            --md-on-secondary: #0E7490;
            --md-on-secondary-container: #164E63;
            --md-tertiary: #F59E42; /* Naranja/ámbar */
            --md-tertiary-container: #FEF3C7;
            --md-on-tertiary: #B45309;
            --md-on-tertiary-container: #78350F;
            --md-success: #10B981; /* Verde esmeralda */
            --md-error: #F43F5E; /* Rosa/rojo moderno */
            --md-error-container: #FEE2E2;
            --md-on-error: #B91C1C;
            --md-on-error-container: #7F1D1D;
            --md-background: #F8FAFC; /* Muy claro */
            --md-surface: #FFFFFF;
            --md-surface-variant: #E0E7EF;
            --md-on-background: #22223B;
            --md-on-surface: #22223B;
            --md-on-surface-variant: #64748B;
            --md-outline: #A5B4FC;
            --md-outline-variant: #C7D2FE;
            --md-shadow: #000000;
            --md-scrim: #000000;
            --md-inverse-surface: #312E81;
            --md-inverse-on-surface: #F8FAFC;
            --md-inverse-primary: #C7D2FE;
            --md-surface-dim: #E0E7EF;
            --md-surface-bright: #FFFFFF;
            --md-surface-container-lowest: #FFFFFF;
            --md-surface-container-low: #F1F5F9;
            --md-surface-container: #F3F4F6;
            --md-surface-container-high: #E5E7EB;
            --md-surface-container-highest: #E0E7EF;
        }

        body {
            font-family: 'Roboto', 'Inter', sans-serif;
            background: var(--md-background);
            margin: 0;
            padding: 0;
            min-height: 100vh;
            color: var(--md-on-background);
        }
        
        .main-container {
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            background: var(--md-surface);
            border-radius: 28px;
            box-shadow: 
                0px 1px 3px 1px rgba(0, 0, 0, 0.15),
                0px 1px 2px 0px rgba(0, 0, 0, 0.30);
            padding: 32px 24px;
            max-width: 900px;
            width: 100%;
            transition: box-shadow 0.2s ease;
        }
        
        .container:hover {
            box-shadow: 
                0px 2px 6px 2px rgba(0, 0, 0, 0.15),
                0px 1px 2px 0px rgba(0, 0, 0, 0.30);
        }
        
        h1 {
            color: var(--md-primary);
            font-size: 32px;
            font-weight: 400;
            margin-bottom: 32px;
            text-align: center;
            line-height: 1.2;
        }
        
        .loading {
            text-align: center;
            color: var(--md-on-surface-variant);
            font-size: 16px;
            padding: 40px 20px;
        }
        
        .error {
            background: var(--md-error-container);
            color: var(--md-on-error-container);
            padding: 16px 20px;
            border-radius: 16px;
            margin: 20px 0;
            font-size: 14px;
            line-height: 1.5;
            box-shadow: 
                0px 1px 3px 1px rgba(0, 0, 0, 0.15),
                0px 1px 2px 0px rgba(0, 0, 0, 0.30);
        }
        
        .results-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 24px;
            background: var(--md-surface-container);
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 
                0px 1px 3px 1px rgba(0, 0, 0, 0.15),
                0px 1px 2px 0px rgba(0, 0, 0, 0.30);
        }
        
        .results-table th {
            background: var(--md-primary-container);
            color: var(--md-on-primary-container);
            padding: 16px 20px;
            text-align: left;
            font-weight: 500;
            font-size: 14px;
        }
        
        .results-table td {
            padding: 16px 20px;
            border-bottom: 1px solid var(--md-outline-variant);
            color: var(--md-on-surface);
            font-size: 14px;
            line-height: 1.4;
        }
        
        .results-table tr:last-child td {
            border-bottom: none;
        }
        
        .results-table tr:hover {
            background: var(--md-surface-container-high);
        }
        
        .count {
            background: var(--md-secondary-container);
            color: var(--md-on-secondary-container);
            padding: 4px 12px;
            border-radius: 12px;
            font-weight: 500;
            font-size: 12px;
            display: inline-block;
        }
        
        @media (max-width: 600px) {
            .container {
                padding: 24px 16px;
                margin: 16px;
            }
            h1 {
                font-size: 28px;
            }
            .results-table {
                font-size: 13px;
            }
            .results-table th,
            .results-table td {
                padding: 12px 16px;
                font-size: 13px;
            }
        }
        
        .rail-menu {
            position: fixed;
            top: 0; left: 0; bottom: 0;
            width: 80px;
            background: var(--md-surface-container);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-top: 24px;
            z-index: 100;
            box-shadow: 
                0px 1px 3px 1px rgba(0, 0, 0, 0.15),
                0px 1px 2px 0px rgba(0, 0, 0, 0.30);
        }
        
        .rail-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin-bottom: 16px;
            color: var(--md-on-surface-variant);
            text-decoration: none;
            font-size: 24px;
            font-weight: 500;
            transition: all 0.2s ease;
            border-radius: 16px;
            padding: 12px 8px 8px 8px;
            width: 56px;
            height: 56px;
            position: relative;
        }
        
        .rail-item span {
            font-size: 11px;
            font-weight: 500;
            margin-top: 4px;
            line-height: 1.2;
        }
        
        .rail-item i { 
            font-size: 20px; 
        }
        
        .rail-item:hover {
            background: var(--md-surface-container-high);
            color: var(--md-on-surface);
        }
        
        .rail-item.active {
            background: var(--md-primary-container);
            color: var(--md-on-primary-container);
        }
        
        @media (max-width: 700px) {
            .rail-menu {
                flex-direction: row;
                width: 100vw;
                height: 80px;
                left: 0; right: 0; top: 0; bottom: unset;
                padding: 0 16px;
                justify-content: space-around;
            }
            .rail-item {
                margin: 0;
                width: 48px;
                height: 48px;
                font-size: 20px;
                padding: 8px 4px 4px 4px;
            }
            .rail-item span {
                font-size: 10px;
            }
            .rail-item i {
                font-size: 18px;
            }
        }
        
        @media (min-width: 701px) and (max-width: 1024px) {
            .rail-menu {
                width: 88px;
            }
            .rail-item {
                width: 64px;
                height: 64px;
                font-size: 28px;
            }
            .rail-item span {
                font-size: 12px;
            }
            .rail-item i {
                font-size: 24px;
            }
        }
        
        .main-container { 
            margin-left: 88px; 
        }
        
        @media (max-width: 700px) {
            .main-container { 
                margin-left: 0; 
                margin-top: 88px; 
            }
        }
    </style>
</head>
<body>
    <nav class="rail-menu">
        <a href="index.html" class="rail-item" title="Síntomas"><i class="fas fa-user-md"></i><span>Síntomas</span></a>
        <a href="introduccion.html" class="rail-item" title="Introducción"><i class="fas fa-lightbulb"></i><span>Intro</span></a>
        <a href="checklist.html" class="rail-item" title="Checklist detonantes"><i class="fas fa-clipboard-list"></i><span>Checklist</span></a>
        <a href="resultados-checklist-sheetdb.html" class="rail-item active" title="Resultados checklist (Resultados)"><i class="fas fa-database"></i><span>Resultados</span></a>
        <a href="juego.html" class="rail-item" title="Juego"><i class="fas fa-gamepad"></i><span>Juego</span></a>
        <a href="herramientas.html" class="rail-item" title="Herramientas"><i class="fas fa-tools"></i><span>Herramientas</span></a>
        <a href="qr.html" class="rail-item" title="QR Code"><i class="fas fa-qrcode"></i><span>QR</span></a>
    </nav>
    <div class="main-container">
        <div class="container">
            <h1>Resultados del Checklist de Ansiedad</h1>
            <div id="loading" class="loading">
                <i class="fas fa-spinner fa-spin"></i> Cargando resultados...
            </div>
            <div id="error" class="error" style="display: none;">
                Error al cargar los datos. Por favor, intenta de nuevo más tarde.
            </div>
            <div id="results" style="display: none;">
                <table class="results-table">
                    <thead>
                        <tr>
                            <th>Detonante</th>
                            <th>Respuestas</th>
                        </tr>
                    </thead>
                    <tbody id="resultsBody">
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <script>
    // Nombres legibles para los síntomas (deben coincidir con los name del formulario)
    const symptomLabels = {
        cambios_cuerpo_emociones: 'Cambios en cuerpo/emociones',
        baja_autoestima: 'Baja autoestima',
        preocupacion_opinion_otros: 'Preocupación por opinión de otros',
        soledad_aislamiento: 'Soledad/aislamiento',
        sensibilidad_irritabilidad: 'Sensibilidad/irritabilidad',
        dificultad_concentracion: 'Dificultad de concentración',
        manejo_emociones_fuertes: 'Manejo de emociones fuertes',
        inseguridad_situaciones_nuevas: 'Inseguridad en situaciones nuevas',
        presion_notas_exito: 'Presión por notas/éxito',
        sobrecarga_tareas: 'Sobrecarga de tareas',
        dificultad_encajar: 'Dificultad para encajar',
        acoso_bullying: 'Acoso escolar/ciberacoso',
        preocupacion_futuro_estudios: 'Preocupación por futuro académico',
        incertidumbre_futuro: 'Incertidumbre sobre el futuro',
        problemas_casa: 'Problemas en casa',
        falta_apoyo_padres: 'Falta de apoyo de padres',
        presion_encajar_grupos: 'Presión por encajar en grupos',
        dependencia_tecnologia: 'Dependencia de tecnología',
        presion_imagen_perfecta: 'Presión por imagen perfecta',
        abrumado_noticias: 'Abrumado por noticias',
        mala_salud: 'Mala salud física/sueño/alimentación',
        habitos_sedentarios: 'Hábitos sedentarios/consumo sustancias',
        auto_medicacion: 'Auto-medicación/auto-diagnóstico',
        pensamientos_autolesion: 'Pensamientos de autolesión/suicidio'
    };
    const symptomKeys = Object.keys(symptomLabels);

    async function fetchResultados() {
        try {
            const res = await fetch('https://sheetdb.io/api/v1/mm4848m7hc4k1');
            if (!res.ok) throw new Error('No se pudo obtener datos de Resultados');
            const data = await res.json();
            processData(data);
        } catch (err) {
            document.getElementById('error').textContent = 'Error al obtener datos de Resultados.';
            document.getElementById('results').style.display = 'none';
        }
    }

    function processData(rows) {
        // Contar los "Sí" de cada campo
        const counts = {};
        symptomKeys.forEach(key => counts[key] = 0);
        rows.forEach(row => {
            symptomKeys.forEach(key => {
                if (row[key] && row[key].toLowerCase().trim() === 'sí') {
                    counts[key]++;
                }
            });
        });
        renderTable(counts);
    }

    function renderTable(counts) {
        // Convertir a array y ordenar de mayor a menor
        const items = symptomKeys.map(key => ({
            key,
            label: symptomLabels[key],
            count: counts[key]
        })).filter(item => item.count > 0).sort((a, b) => b.count - a.count);
        if (items.length === 0) {
            document.getElementById('resultsBody').innerHTML = '<div style="text-align:center; color:#888; font-size:1.1em; margin-top:2em;">No hay resultados aún.</div>';
            return;
        }
        let html = '<table><thead><tr><th>Detonante</th><th>Veces seleccionado</th></tr></thead><tbody>';
        items.forEach(item => {
            html += `<tr><td>${item.label}</td><td style="text-align:center; font-weight:700;">${item.count}</td></tr>`;
        });
        html += '</tbody></table>';
        document.getElementById('resultsBody').innerHTML = html;
        document.getElementById('loading').style.display = 'none';
        document.getElementById('results').style.display = 'block';
    }

    fetchResultados();
    </script>
</body>
</html> 